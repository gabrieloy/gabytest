<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lovelace | Strategic Intelligence Interface</title>
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        .animate-in { animation: fadeIn 0.25s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        textarea { resize: none; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const generateTrendData = (base, volatility) => 
            Array.from({ length: 30 }, () => Math.floor(base + (Math.random() - 0.5) * volatility));

        const mockCompanies = [
            { id: 1, name: 'Nubank', domain: 'nubank.com.br', fit: 98, industry: 'Fintech', region: 'LATAM', theme: 'fintech banking digital growth', metrics: { mau: { label: 'Monthly Active Users', current: '85M', trend: generateTrendData(80, 5), description: 'Representing a 12% YoY increase in active engagement across core LATAM markets.' }, dau: { label: 'Daily Active Users', current: '32M', trend: generateTrendData(30, 3), description: 'Daily stickiness remains high.' }, downloads: { label: 'App Downloads', current: '4.2M', trend: generateTrendData(4, 1), description: 'Download velocity peaked following recent campaign.' } } },
            { id: 2, name: 'FREENOW', domain: 'free-now.com', fit: 92, industry: 'Mobility', region: 'EMEA', theme: 'urban mobility', metrics: { mau: { label: 'Monthly Active Users', current: '12M', trend: generateTrendData(11, 2), description: 'Stable user base with high migration toward the new Super App UI.' }, dau: { label: 'Daily Active Users', current: '2.5M', trend: generateTrendData(2, 0.5), description: 'Peak usage observed during commute hours.' }, downloads: { label: 'App Downloads', current: '800K', trend: generateTrendData(0.8, 0.2), description: 'Seasonality indicates a focus shift to driver retention.' } } },
            { id: 3, name: 'Mercado Libre', domain: 'mercadolivre.com', fit: 96, industry: 'E-commerce', region: 'LATAM', theme: 'retail finance logistics', metrics: { mau: { label: 'Monthly Active Users', current: '148M', trend: generateTrendData(140, 10), description: 'Dominating regional e-commerce traffic.' }, dau: { label: 'Daily Active Users', current: '54M', trend: generateTrendData(50, 5), description: 'High daily usage via Meli+ loyalty program.' }, downloads: { label: 'App Downloads', current: '8.5M', trend: generateTrendData(8, 2), description: 'Strong growth in Mercado Pago.' } } },
            { id: 4, name: 'Rappi', domain: 'rappi.com', fit: 94, industry: 'Super App', region: 'LATAM', theme: 'delivery logistics', metrics: { mau: { label: 'Monthly Active Users', current: '25M', trend: generateTrendData(22, 4), description: 'Growth in Turbo vertical.' }, dau: { label: 'Daily Active Users', current: '7M', trend: generateTrendData(6, 1), description: 'High frequency user base.' }, downloads: { label: 'App Downloads', current: '1.2M', trend: generateTrendData(1, 0.3), description: 'Regional dominance focus.' } } }
        ];

        const mockPeople = {
            1: [
                { id: 'p1', name: 'Guilherme Lago', role: 'CFO', initials: 'GL', summary: 'Architect of shift to profitability.', linkedin: '#', responsibilities: 'Directs financial operations and capital allocation.', psychographic: 'Highly analytical and data-driven.' },
                { id: 'p2', name: 'Cristina Junqueira', role: 'CGO', initials: 'CJ', summary: 'Leading expansion in Mexico.', linkedin: '#', responsibilities: 'Oversees global growth and localization.', psychographic: 'Visionary but grounded in unit economics.' },
                { id: 'p11', name: 'Juliana Garcia', role: 'Growth Manager', initials: 'JG', summary: 'Funnel optimization expert.', linkedin: '#', responsibilities: 'Mexico UA management and creative testing.', psychographic: 'Pragmatic and results-oriented.' }
            ],
            2: [{ id: 'p4', name: 'Thomas Zimmermann', role: 'CEO', initials: 'TZ', summary: 'Super App transition lead.', linkedin: '#', responsibilities: 'Unified strategy.', psychographic: 'Strategic polymath.' }]
        };

        const companyIntel = {
            1: [
                { id: 's1', type: 'Investor Relations', label: 'Efficiency Guidance', insight: 'Targeting 50% efficiency ratios.', fullText: 'CFO emphasized Mexico expansion as the benchmark for automation.' },
                { id: 's5', type: 'Ad Intelligence', label: 'Creative Fatigue Spike', insight: 'CPM decay up 40% in Mexico.', fullText: 'Static assets showing audience saturation on TikTok.' },
                { id: 's2', type: 'Apptopia Trend', label: 'Retention Anomaly', insight: 'Cajitas users show 3.5x higher LTV.', fullText: 'Mexico retention metrics show high stickiness for localized products.' }
            ]
        };

        const mockLastNews = {
            1: [
                { id: 'n1', title: "Nubank Surpasses 100M Customers", source: "Bloomberg", time: "2h ago", content: "Historic milestone reached across LATAM.", relevance: "Demands hyper-scale automation like Jampp." },
                { id: 'n2', title: "Nu Mexico Expands High-Yield", source: "Reuters", time: "5h ago", content: "New tiers for 'Cajitas'.", relevance: "Requires automated creative versioning for tiers." }
            ]
        };

        const strategies = [
            { id: 'architect', name: 'The Architect' },
            { id: 'visualizer', name: 'The Visualizer' },
            { id: 'disruptor', name: 'The Disruptor' },
            { id: 'storyteller', name: 'The Storyteller' }
        ];

        const Icon = ({ name, size = 16, className = "", color = "currentColor" }) => {
            useEffect(() => { if (window.lucide) window.lucide.createIcons(); }, [name]);
            return <i data-lucide={name} style={{ width: size, height: size, color: color }} className={className}></i>;
        };

        const Sparkline = ({ data, color }) => {
            const min = Math.min(...data);
            const max = Math.max(...data);
            const range = Math.max(max - min, 1);
            const width = 120;
            const height = 30;
            const points = data.map((val, i) => `${(i / (data.length - 1)) * width},${height - ((val - min) / range) * height}`).join(' ');
            return (
                <svg width={width} height={height} className="overflow-visible">
                    <polyline fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" points={points} />
                </svg>
            );
        };

        const MetricCard = ({ label, metric, icon, color, stroke, onClick }) => (
            <button onClick={() => onClick(metric)} className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex flex-col justify-between text-left hover:border-indigo-400 hover:shadow-md transition-all group">
                <div className="flex items-center justify-between mb-2">
                    <div className="flex items-center gap-2">
                        <div className={`p-1.5 rounded-lg bg-slate-50 ${color}`}>
                            <Icon name={icon} size={14} />
                        </div>
                        <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{label}</span>
                    </div>
                    <span className="text-[12px] font-black text-slate-900">{metric?.current || 'N/A'}</span>
                </div>
                <div className="flex items-end justify-between pt-2">
                    <Sparkline data={metric?.trend || [50, 50]} color={stroke} />
                    <Icon name="maximize-2" size={10} className="text-slate-300 group-hover:text-indigo-500 opacity-0 group-hover:opacity-100 transition-all" />
                </div>
            </button>
        );

        const App = () => {
            const [selectedCompany, setSelectedCompany] = useState(mockCompanies[0]);
            const [selectedPerson, setSelectedPerson] = useState(mockPeople[1][0]);
            const [selectedStrategy, setSelectedStrategy] = useState('architect');
            const [selectedChannel, setSelectedChannel] = useState('email');
            const [draft, setDraft] = useState('');
            const [isEditing, setIsEditing] = useState(false);
            const [activeSignal, setActiveSignal] = useState(null);
            const [activeMetric, setActiveMetric] = useState(null);
            const [activePersonModal, setActivePersonModal] = useState(null);
            const [activeNewsModal, setActiveNewsModal] = useState(null);
            const [selectedContexts, setSelectedContexts] = useState([]);
            const [generatedImage, setGeneratedImage] = useState(null);

            const isLinkedIn = selectedChannel === 'linkedin';

            useEffect(() => {
                const firstName = selectedPerson.name.split(' ')[0];
                const intel = companyIntel[selectedCompany.id]?.[0]?.insight || "your growth targets";
                
                if (selectedChannel === 'linkedin') {
                    setDraft(`Hi ${firstName}, noticed the team is leaning into ${intel.toLowerCase().slice(0, 35)}... scaling this manually is essentially a "growth tax." Jampp decouples that scale from creative labor. Worth a look? Regards, Gaby`);
                } else {
                    const opening = `Hi ${firstName},`;
                    const body = `I noticed your team is prioritizing ${intel.toLowerCase().slice(0, 45)}... it's a smart shift. However, scaling this manually often creates a "hidden tax" on your growth.\n\nAt Jampp, we help category leaders decouple growth from manual creative headcount. Let me know if you'd like to see the specific data we prepared for ${selectedCompany.name}.\n\nRegards,\nGaby`;
                    setDraft(`${opening}\n\n${body}`);
                }
            }, [selectedCompany, selectedPerson, selectedStrategy, selectedChannel, selectedContexts]);

            const handleCompanyChange = (c) => {
                setSelectedCompany(c);
                setSelectedPerson(mockPeople[c.id]?.[0] || mockPeople[1][0]);
                setSelectedContexts([]);
            };

            const addContext = (context) => {
                if (!selectedContexts.find(c => c.id === context.id)) {
                    setSelectedContexts([...selectedContexts, { id: context.id, type: context.type, label: context.label || context.source }]);
                }
            };

            const removeContext = (id) => setSelectedContexts(selectedContexts.filter(c => c.id !== id));

            const displayOpening = isLinkedIn ? "" : draft.split('\n\n')[0] || "";
            const displayBody = isLinkedIn ? draft : draft.split('\n\n')[1] || "";
            const displayClosing = isLinkedIn ? "" : draft.split('\n\n')[2] || "";

            return (
                <div className="flex h-screen bg-slate-50 text-[13px] overflow-hidden">
                    {/* Sidebar */}
                    <aside className="w-80 bg-white border-r border-slate-200 flex flex-col shadow-sm">
                        <div className="p-6 border-b border-slate-100">
                            <div className="flex items-center gap-2 mb-6">
                                <div className="bg-indigo-600 p-2 rounded text-white shadow-sm"><Icon name="zap" /></div>
                                <h1 className="font-black text-lg tracking-tight uppercase leading-none text-slate-900">Lovelace</h1>
                            </div>
                            <div className="relative">
                                <Icon name="search" size={14} className="absolute left-3 top-2.5 text-slate-400" />
                                <input type="text" placeholder="Search accounts..." className="w-full pl-9 pr-4 py-2 bg-slate-50 rounded border border-slate-100 focus:outline-none focus:ring-1 focus:ring-indigo-500 text-xs" />
                            </div>
                        </div>
                        <nav className="flex-1 overflow-y-auto no-scrollbar">
                            {mockCompanies.map((c) => (
                                <button key={c.id} onClick={() => handleCompanyChange(c)} className={`w-full flex items-center justify-between p-4 border-b border-slate-50 transition-all ${selectedCompany.id === c.id ? 'bg-indigo-600 text-white shadow-lg relative z-10' : 'hover:bg-slate-50'}`}>
                                    <div className="text-left"><p className="font-bold">{c.name}</p><p className={`text-[10px] ${selectedCompany.id === c.id ? 'opacity-70' : 'text-slate-400'}`}>{c.domain}</p></div>
                                    <span className={`text-[9px] font-black px-1.5 py-0.5 rounded ${selectedCompany.id === c.id ? 'bg-white/10' : 'bg-slate-100 text-slate-600'}`}>{c.fit}%</span>
                                </button>
                            ))}
                        </nav>
                    </aside>

                    <main className="flex-1 overflow-y-auto flex flex-col bg-[#F9FAFB]">
                        <header className="bg-white p-6 border-b border-slate-200 flex justify-between items-center sticky top-0 z-30 shadow-sm">
                            <div className="flex items-center gap-4">
                                <div className="h-12 w-12 rounded bg-slate-900 flex items-center justify-center font-bold text-white text-xl shadow-inner">{selectedCompany.name[0]}</div>
                                <div>
                                    <h2 className="font-bold text-lg">{selectedCompany.name}</h2>
                                    <p className="text-[11px] text-slate-500 font-medium flex gap-2"><span>{selectedCompany.region}</span> • <span>{selectedCompany.industry}</span></p>
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <span className="text-[10px] font-black text-emerald-600 bg-emerald-50 px-2.5 py-1 rounded-full flex items-center gap-1.5"><span className="h-1.5 w-1.5 bg-emerald-500 rounded-full animate-pulse"></span> ANALYTICS SYNCED</span>
                            </div>
                        </header>

                        <div className="p-8 max-w-7xl mx-auto w-full space-y-6">
                            
                            <section className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <MetricCard label="Monthly Active Users" metric={selectedCompany.metrics.mau} icon="users" color="text-indigo-600" stroke="#6366f1" onClick={setActiveMetric} />
                                <MetricCard label="Daily Active Users" metric={selectedCompany.metrics.dau} icon="activity" color="text-emerald-600" stroke="#10b981" onClick={setActiveMetric} />
                                <MetricCard label="App Downloads" metric={selectedCompany.metrics.downloads} icon="download" color="text-amber-600" stroke="#f59e0b" onClick={setActiveMetric} />
                            </section>

                            <section className="animate-in">
                                <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2"><Icon name="user-check" size={12} /> Strategic Contacts</h3>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    {(mockPeople[selectedCompany.id] || mockPeople[1]).map(p => (
                                        <button key={p.id} onClick={() => { setSelectedPerson(p); setActivePersonModal(p); }} className={`p-4 rounded border text-left transition-all group ${selectedPerson.id === p.id ? 'bg-white border-indigo-600 ring-2 ring-indigo-600/5 shadow-lg scale-[1.02]' : 'bg-white border-slate-100 hover:border-slate-300'}`}>
                                            <div className="flex items-center gap-3 mb-2">
                                                <div className="h-8 w-8 rounded-full bg-slate-100 flex items-center justify-center text-[10px] font-bold border border-slate-200">{p.initials}</div>
                                                <div className="flex-1">
                                                    <p className="font-bold text-xs flex items-center justify-between">{p.name} <Icon name="info" size={12} className="text-slate-300 group-hover:text-indigo-600 transition-all" /></p>
                                                    <p className="text-[10px] text-indigo-600 font-bold uppercase">{p.role}</p>
                                                </div>
                                            </div>
                                            <p className="text-[11px] text-slate-500 leading-snug line-clamp-2">{p.summary}</p>
                                        </button>
                                    ))}
                                </div>
                            </section>

                            <div className="grid grid-cols-12 gap-8 pt-2">
                                <div className="col-span-4 space-y-6">
                                    <section>
                                        <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2"><Icon name="target" size={14} className="text-indigo-600" /> Strategic Intelligence</h3>
                                        <div className="space-y-4">
                                            {(companyIntel[selectedCompany.id] || []).map((intel) => (
                                                <button key={intel.id} onClick={() => setActiveSignal(intel)} className="w-full text-left bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:border-indigo-600 hover:shadow-md transition-all group overflow-hidden">
                                                    <div className="flex justify-between items-start mb-2">
                                                        <span className={`text-[8px] font-black px-1.5 py-0.5 rounded border uppercase ${
                                                            intel.type.includes('Investor') ? 'bg-amber-50 text-amber-700 border-amber-200' : 
                                                            intel.type.includes('Apptopia') ? 'bg-indigo-50 text-indigo-700 border-indigo-200' : 
                                                            intel.type.includes('Ad') ? 'bg-rose-50 text-rose-700 border-rose-200' : 'bg-slate-50 text-slate-600'
                                                        }`}>{intel.type}</span>
                                                        <Icon name="maximize-2" size={12} className="text-slate-300 group-hover:text-indigo-600" />
                                                    </div>
                                                    <p className="font-bold text-slate-900 mb-1 leading-tight text-[12px]">{intel.label}</p>
                                                    <p className="text-slate-500 text-[11px] line-clamp-2 italic">"{intel.insight}"</p>
                                                </button>
                                            ))}
                                        </div>
                                    </section>

                                    <section className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                        <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4 flex items-center gap-2"><Icon name="newspaper" size={14} className="text-indigo-600" /> Last News</h3>
                                        <div className="space-y-4">
                                            {(mockLastNews[selectedCompany.id] || []).map((news, idx) => (
                                                <div key={idx} onClick={() => setActiveNewsModal(news)} className="group cursor-pointer">
                                                    <div className="flex justify-between items-start mb-1">
                                                        <span className="text-[9px] font-bold text-indigo-600 uppercase">{news.source}</span>
                                                        <div className="flex items-center gap-1 text-[9px] text-slate-400"><Icon name="clock" size={10} /> {news.time}</div>
                                                    </div>
                                                    <p className="text-[11px] font-semibold text-slate-800 leading-snug group-hover:text-indigo-600 transition-colors">{news.title}</p>
                                                    <div className="mt-2 h-px bg-slate-50 group-last:hidden"></div>
                                                </div>
                                            ))}
                                        </div>
                                    </section>
                                </div>

                                <div className="col-span-8 space-y-6">
                                    <div className="bg-white rounded-xl border border-slate-200 shadow-xl flex flex-col overflow-hidden min-h-[700px]">
                                        <div className="px-6 py-4 bg-white border-b border-slate-100 flex justify-between items-center">
                                            <div className="flex items-center gap-3 text-slate-400"><Icon name="layout" size={16}/><span className="font-black text-[10px] uppercase tracking-widest">Consultative Composer</span></div>
                                            <div className="flex items-center gap-1 bg-slate-100 p-1 rounded-lg">
                                                <button onClick={() => setSelectedChannel('email')} className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[10px] font-bold transition-all ${selectedChannel === 'email' ? 'bg-white shadow-sm text-indigo-600' : 'text-slate-500 hover:text-slate-700'}`}><Icon name="mail" size={12} /> Email</button>
                                                <button onClick={() => setSelectedChannel('linkedin')} className={`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-[10px] font-bold transition-all ${selectedChannel === 'linkedin' ? 'bg-white shadow-sm text-[#0077b5]' : 'text-slate-500 hover:text-slate-700'}`}><Icon name="linkedin" size={12} /> LinkedIn</button>
                                            </div>
                                        </div>

                                        <div className="px-8 py-3 bg-slate-50 border-b border-slate-100 flex items-center gap-2"><span className="text-[9px] font-black text-slate-400 uppercase mr-2 tracking-widest">Framework:</span><div className="flex gap-2 flex-1">{strategies.map(s => (<button key={s.id} onClick={() => setSelectedStrategy(s.id)} className={`px-3 py-1 rounded text-[10px] font-bold transition-all border ${selectedStrategy === s.id ? 'bg-indigo-600 text-white border-indigo-600 shadow-sm' : 'bg-white text-slate-500 border-slate-200 hover:border-slate-300'}`}>{s.name}</button>))}</div></div>
                                        
                                        {selectedContexts.length > 0 && (
                                            <div className="px-8 py-3 bg-indigo-50 border-b border-indigo-100 flex items-center gap-3 animate-in">
                                                <span className="text-[9px] font-black text-indigo-400 uppercase tracking-widest whitespace-nowrap">Context Points:</span>
                                                <div className="flex flex-wrap gap-2">
                                                    {selectedContexts.map((context) => (
                                                        <div key={context.id} className="flex items-center gap-1.5 px-2.5 py-1 bg-white border border-indigo-100 rounded-lg shadow-sm text-indigo-600 animate-in fade-in zoom-in-95 duration-200">
                                                            <span className="text-[10px] font-black uppercase tracking-tighter">{context.type.split(' ')[0]}</span>
                                                            <span className="h-3 w-px bg-indigo-100"></span>
                                                            <span className="text-[10px] font-medium truncate max-w-[120px]">{context.label}</span>
                                                            <button onClick={() => removeContext(context.id)} className="p-0.5 hover:bg-indigo-50 rounded-md text-indigo-300 hover:text-indigo-600 transition-colors"><Icon name="x" size={10} /></button>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        <div className="p-10 flex-1 space-y-4 animate-in fade-in duration-500">
                                            <div className="flex items-center gap-2 text-[12px] text-slate-400 font-medium pb-4 border-b border-slate-50 mb-4"><span>Recipient: <strong className="text-slate-900">{selectedPerson.name}</strong></span></div>
                                            {isEditing ? (
                                                <textarea value={draft} onChange={(e) => setDraft(e.target.value)} className="w-full h-96 border-none focus:ring-0 p-0 text-[14px] leading-relaxed text-slate-700 font-sans" />
                                            ) : (
                                                <>
                                                    {!isLinkedIn && <p className="text-[14px] font-medium text-slate-800">{displayOpening}</p>}
                                                    <div className="whitespace-pre-wrap text-[14px] leading-relaxed text-slate-700">{isLinkedIn ? draft : displayBody}</div>
                                                    {!isLinkedIn && (
                                                        <div className="my-6 relative rounded-xl overflow-hidden border border-slate-200 bg-slate-50 flex flex-col shadow-inner min-h-[200px] justify-center text-center text-slate-300">
                                                            <Icon name="image" size={32} className="mx-auto mb-2" />
                                                            <p className="text-[10px]">Visual context asset placeholder</p>
                                                        </div>
                                                    )}
                                                    {!isLinkedIn && <p className="text-[14px] leading-relaxed text-slate-700 whitespace-pre-line">{displayClosing}</p>}
                                                </>
                                            )}
                                        </div>

                                        <div className="mt-8 p-10 pt-6 border-t border-slate-100 flex justify-between items-center">
                                            <button onClick={() => setIsEditing(!isEditing)} className="text-[10px] font-black text-slate-400 uppercase tracking-widest hover:text-indigo-600 flex items-center gap-2 transition-all"><Icon name="edit-3" size={14}/> {isEditing ? 'SAVE' : 'MANUAL OVERRIDE'}</button>
                                            <div className="flex gap-3">
                                                {isLinkedIn && (
                                                    <a href={selectedPerson.linkedin} target="_blank" className="px-6 py-3 bg-white border border-slate-200 text-slate-700 rounded text-[10px] font-black uppercase tracking-widest hover:bg-slate-50 transition-all flex items-center gap-2 shadow-sm"><Icon name="user" size={14} /> Go to Profile</a>
                                                )}
                                                <button className={`px-8 py-3 rounded text-[10px] font-black uppercase tracking-[0.2em] transition-all shadow-xl flex items-center gap-2 ${selectedChannel === 'linkedin' ? 'bg-[#0077b5] hover:bg-[#006097] text-white' : 'bg-slate-900 hover:bg-black text-white'}`}>
                                                    {selectedChannel === 'linkedin' ? <Icon name="copy" size={14} /> : <Icon name="send" size={14} />} {selectedChannel === 'linkedin' ? 'COPY TEXT' : 'SEND AS GABY'}
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>

                    {/* Modals implement deep dives */}
                    {activeMetric && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in">
                            <div className="bg-white w-full max-w-xl rounded-2xl shadow-2xl overflow-hidden animate-in zoom-in-95">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                    <div className="flex items-center gap-3"><div className="p-2 bg-white rounded-lg border border-slate-200 text-indigo-600 shadow-sm"><Icon name="activity" size={20}/></div><div><h4 className="font-bold text-slate-900">{activeMetric.label} Analysis</h4><p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Historical Performance</p></div></div>
                                    <button onClick={() => setActiveMetric(null)} className="p-2 hover:bg-slate-200 rounded-lg text-slate-400"><Icon name="x" size={20}/></button>
                                </div>
                                <div className="p-10 space-y-8 text-slate-700">
                                    <div className="flex items-end justify-between"><p className="text-5xl font-black text-slate-900">{activeMetric.current}</p><p className="text-sm font-black text-emerald-600 uppercase tracking-widest">↗ High Fit</p></div>
                                    <p className="text-slate-600 leading-relaxed text-[14px] italic">"{activeMetric.description}"</p>
                                    <button onClick={() => setActiveMetric(null)} className="w-full py-3 font-bold text-[11px] uppercase tracking-widest bg-slate-900 text-white rounded-lg hover:bg-black transition-all">Close Analytics</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {activeSignal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in">
                            <div className="bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden animate-in zoom-in-95">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                    <div className="flex items-center gap-3">
                                        <div className={`p-2 rounded-lg shadow-sm text-white ${activeSignal.type.includes('Ad') ? 'bg-rose-600' : 'bg-indigo-600'}`}>{activeSignal.type.includes('Ad') ? <Icon name="monitor-play" size={20} /> : <Icon name="shield-check" size={20}/>}</div>
                                        <div><h4 className="font-bold text-slate-900">{activeSignal.type} Deep Dive</h4><p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Source Verified</p></div>
                                    </div>
                                    <button onClick={() => setActiveSignal(null)} className="p-2 hover:bg-slate-200 rounded-lg text-slate-400"><Icon name="x" size={20}/></button>
                                </div>
                                <div className="p-8 space-y-6">
                                    <h5 className="font-bold text-slate-900 text-lg leading-tight">{activeSignal.label}</h5>
                                    <div className={`p-6 rounded-xl border ${activeSignal.type.includes('Ad') ? 'bg-rose-50 border-rose-100' : 'bg-indigo-50/50 border-indigo-100'}`}><p className="text-slate-700 leading-relaxed text-[14px]">{activeSignal.fullText}</p></div>
                                    <div className="p-4 bg-slate-50 rounded-xl flex gap-3"><button onClick={() => { addContext(activeSignal); setActiveSignal(null); }} className="flex-1 py-3 font-bold text-[11px] uppercase tracking-widest bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all flex items-center justify-center gap-2"><Icon name="plus" size={14} /> Add Context</button><button onClick={() => setActiveSignal(null)} className="px-6 py-3 font-bold text-[11px] uppercase text-slate-400">Dismiss</button></div>
                                </div>
                            </div>
                        </div>
                    )}

                    {activePersonModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in">
                            <div className="bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden animate-in zoom-in-95">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                    <div className="flex items-center gap-3"><div className="h-10 w-10 rounded-full bg-indigo-600 flex items-center justify-center font-bold text-white shadow-lg">{activePersonModal.initials}</div><div><h4 className="font-bold text-slate-900">{activePersonModal.name}</h4><p className="text-[10px] font-bold text-indigo-600 uppercase tracking-widest">{activePersonModal.role}</p></div></div>
                                    <button onClick={() => setActivePersonModal(null)} className="p-2 hover:bg-slate-200 rounded-lg text-slate-400"><Icon name="x" size={20}/></button>
                                </div>
                                <div className="p-8 space-y-6 max-h-[70vh] overflow-y-auto no-scrollbar text-slate-700">
                                    <div className="p-4 bg-slate-50 rounded-xl flex items-center justify-between border border-slate-100">
                                        <div className="flex items-center gap-3 text-indigo-600"><Icon name="linkedin" size={16}/><span className="text-[11px] font-bold text-slate-500">LinkedIn Profile</span></div>
                                        <a href={activePersonModal.linkedin} target="_blank" className="text-[11px] font-bold text-indigo-600 hover:underline flex items-center gap-1">View Profile <Icon name="external-link" size={10} /></a>
                                    </div>
                                    <div><h5 className="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2">Responsibilities</h5><p className="text-[14px] text-slate-700 leading-relaxed font-medium">{activePersonModal.responsibilities}</p></div>
                                    <div className="bg-slate-900 p-6 rounded-2xl text-white relative overflow-hidden group"><Icon name="sparkles" size={48} className="absolute top-0 right-0 p-4 opacity-10" /><h5 className="text-[10px] font-black text-indigo-300 uppercase tracking-widest mb-3">Psychographic Insights</h5><p className="text-[14px] leading-relaxed italic text-white/90">{activePersonModal.psychographic}</p></div>
                                </div>
                                <div className="p-4 bg-slate-50 border-t border-slate-100"><button onClick={() => setActivePersonModal(null)} className="w-full py-3 font-bold text-[11px] uppercase bg-slate-900 text-white rounded-lg">Close Profile</button></div>
                            </div>
                        </div>
                    )}

                    {activeNewsModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm p-4 animate-in">
                            <div className="bg-white w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden animate-in zoom-in-95">
                                <div className="p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50">
                                    <div className="flex items-center gap-3"><div className="p-2 bg-indigo-600 rounded-lg text-white shadow-sm"><Icon name="newspaper" size={20}/></div><div><h4 className="font-bold text-slate-900">Intelligence Brief</h4><p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{activeNewsModal.source}</p></div></div>
                                    <button onClick={() => setActiveNewsModal(null)} className="p-2 hover:bg-slate-200 rounded-lg text-slate-400"><Icon name="x" size={20}/></button>
                                </div>
                                <div className="p-8 space-y-6 max-h-[70vh] overflow-y-auto no-scrollbar text-slate-700">
                                    <p className="font-bold text-slate-900 text-lg leading-tight tracking-tight">{activeNewsModal.title}</p>
                                    <p className="text-[14px] text-slate-700 leading-relaxed">{activeNewsModal.content}</p>
                                    <div className="bg-emerald-50 p-6 rounded-2xl border border-emerald-100 relative overflow-hidden group">
                                        <Icon name="lightbulb" size={48} className="absolute top-0 right-0 p-4 opacity-20 text-emerald-600" />
                                        <h5 className="text-[10px] font-black text-emerald-700 uppercase tracking-widest mb-3 flex items-center gap-2"><Icon name="zap" size={12} /> Jampp Angle</h5>
                                        <p className="text-[14px] text-slate-900 font-medium leading-relaxed">{activeNewsModal.relevance}</p>
                                    </div>
                                    <div className="flex gap-3"><button onClick={() => { addContext({ ...activeNewsModal, type: 'News' }); setActiveNewsModal(null); }} className="flex-1 py-3 font-bold text-[11px] uppercase bg-indigo-600 text-white rounded-lg flex items-center justify-center gap-2 shadow-lg shadow-indigo-200 transition-all"><Icon name="plus" size={14} /> Add context</button><button onClick={() => setActiveNewsModal(null)} className="px-6 py-3 font-bold text-[11px] text-slate-400">Close</button></div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
